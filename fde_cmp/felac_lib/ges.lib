sub d1lh2.sub(v1,v2,st1,st2)
v1= (1.-rx)*(2.-rx-rx*rx)/4.
v2= (1.+rx)*(2.+rx-rx*rx)/4.
st1= (rx+1.)*(rx-1.)*(rx-1.)/4.
st2= (rx-1.)*(rx+1.)*(rx-1.)/4.
end d1lh2.sub

sub d1l2.sub(u1,u2,x)
u1=(1.-x)/2
u2=(1.+x)/2
end d1l2.sub

sub d1l3.sub(u1,u2,u3,x)
u1=x*(x-1.)/2
u3=(1.-x*x)
u2=x*(1.+x)/2
end d1l3.sub

sub d1l4.sub(u1,u2,u3,u4,x)
u1=(1.-x)*(9.*x*x-1.)/16
u3=(1.-x*x)*(1-1./3*9*x)*9/16
u4=(1.-x*x)*(1+1./3*9*x)*9/16
u2=(1.+x)*(9.*x*x-1.)/16
end d1l4.sub

sub d1l5.sub(u1,u2,u3,u4,u5,x)
u1=x*(x-1.)*(7.-4.*x*x)/6
u2=x*(1.+x)*(7.-4.*x*x)/6
u3=1./2*4*x*(x*x-1.)*(1.-1./2*4*x)
u4=1./2*4*x*(1.-x*x)*(1.+1./2*4*x)
u5=(1.-4.*x*x)*(1.-x*x)
end d1l5.sub

sub d2q4c.sub(u1,u2,u3,u4,x,y)
u1 = 1./4
u2 = 1./4
u3 = 1./4
u4 = 1./4
end d2q4c.sub

sub d2q4.sub(u1,u2,u3,u4,x,y)
u1 = (1.-x)/2*(1.-y)/2
u2 = (1.+x)/2*(1.-y)/2
u3 = (1.+x)/2*(1.+y)/2
u4 = (1.-x)/2*(1.+y)/2
end d2q4.sub

sub d2q4a.sub(u1,ux1,uy1,u2,ux2,uy2,u3,ux3,uy3,u4,ux4,uy4,x,y)
u1 = (1.-x)/2*(1.-y)/2*(2.-x-y-x*x-y*y)/2
u2 = (1.+x)/2*(1.-y)/2*(2.+x-y-x*x-y*y)/2
u3 = (1.+x)/2*(1.+y)/2*(2.+x+y-x*x-y*y)/2
u4 = (1.-x)/2*(1.+y)/2*(2.-x+y-x*x-y*y)/2
ux1 = -(1.-x)*(1.-y)*(1.-y)*(-1.-y)/8
ux2 = -(1.+x)*(1.-y)*(1.-y)*(-1.-y)/8
ux3 = +(1.+x)*(1.+y)*(1.+y)*(-1.+y)/8
ux4 = +(1.-x)*(1.+y)*(1.+y)*(-1.+y)/8
uy1 = +(1.-x)*(1.-x)*(-1.-x)*(1.-y)/8
uy2 = -(1.+x)*(1.+x)*(-1.+x)*(1.-y)/8
uy3 = -(1.+x)*(1.+x)*(-1.+x)*(1.+y)/8
uy4 = +(1.-x)*(1.-x)*(-1.-x)*(1.+y)/8
end d2q4a.sub

sub d2q4m.sub(u1,ux1,uy1,u2,ux2,uy2,u3,ux3,uy3,u4,ux4,uy4,x,y)
u1 = (1.-x)/2*(1.-y)/2*(2.-x-y-x*x-y*y)/2
u2 = (1.+x)/2*(1.-y)/2*(2.+x-y-x*x-y*y)/2
u3 = (1.+x)/2*(1.+y)/2*(2.+x+y-x*x-y*y)/2
u4 = (1.-x)/2*(1.+y)/2*(2.-x+y-x*x-y*y)/2
ux1 = -(1.-x)*(1.-y)*(1.-y)*(-1.-y)/8*rctc(2,1)
ux2 = -(1.+x)*(1.-y)*(1.-y)*(-1.-y)/8*rctc(2,1)
ux3 = +(1.+x)*(1.+y)*(1.+y)*(-1.+y)/8*rctc(2,1)
ux4 = +(1.-x)*(1.+y)*(1.+y)*(-1.+y)/8*rctc(2,1)
uy1 = +(1.-x)*(1.-x)*(-1.-x)*(1.-y)/8*rctc(1,2)
uy2 = -(1.+x)*(1.+x)*(-1.+x)*(1.-y)/8*rctc(1,2)
uy3 = -(1.+x)*(1.+x)*(-1.+x)*(1.+y)/8*rctc(1,2)
uy4 = +(1.-x)*(1.-x)*(-1.-x)*(1.+y)/8*rctc(1,2)
end d2q4m.sub

sub d2q4mv.sub(w1,wx1,wy1,w2,wx2,wy2,w3,wx3,wy3,w4,wx4,wy4,x,y,rx,ry)
w1 = (1.-rx)/2*(1.-ry)/2*(2.-rx-ry-rx*rx-ry*ry)/2
w2 = (1.+rx)/2*(1.-ry)/2*(2.+rx-ry-rx*rx-ry*ry)/2
w3 = (1.+rx)/2*(1.+ry)/2*(2.+rx+ry-rx*rx-ry*ry)/2
w4 = (1.-rx)/2*(1.+ry)/2*(2.-rx+ry-rx*rx-ry*ry)/2
wx1 = -(1.-rx)*(1.-ry)*(1.-ry)*(-1.-ry)*{y/ry}/8-(1.-rx)*(1.-rx)*(-1.-rx)*(1.-ry)*{y/rx}/8
wx2 = -(1.+rx)*(1.-ry)*(1.-ry)*(-1.-ry)*{y/ry}/8+(1.+rx)*(1.+rx)*(-1.+rx)*(1.-ry)*{y/rx}/8
wx3 = +(1.+rx)*(1.+ry)*(1.+ry)*(-1.+ry)*{y/ry}/8+(1.+rx)*(1.+rx)*(-1.+rx)*(1.+ry)*{y/rx}/8
wx4 = +(1.-rx)*(1.+ry)*(1.+ry)*(-1.+ry)*{y/ry}/8-(1.-rx)*(1.-rx)*(-1.-rx)*(1.+ry)*{y/rx}/8
wy1 = +(1.-rx)*(1.-rx)*(-1.-rx)*(1.-ry)*{x/rx}/8+(1.-rx)*(1.-ry)*(1.-ry)*(-1.-ry)*{x/ry}/8
wy2 = -(1.+rx)*(1.+rx)*(-1.+rx)*(1.-ry)*{x/rx}/8+(1.+rx)*(1.-ry)*(1.-ry)*(-1.-ry)*{x/ry}/8
wy3 = -(1.+rx)*(1.+rx)*(-1.+rx)*(1.+ry)*{x/rx}/8-(1.+rx)*(1.+ry)*(1.+ry)*(-1.+ry)*{x/ry}/8
wy4 = +(1.-rx)*(1.-rx)*(-1.-rx)*(1.+ry)*{x/rx}/8-(1.-rx)*(1.+ry)*(1.+ry)*(-1.+ry)*{x/ry}/8
end d2q4mv.sub

sub d2q8.sub(u1,u2,u3,u4,u5,u6,u7,u8,x,y)
u1 = (1.-x)/2*(1.-y)*(-x-y-1.)/2
u2 = (1.+x)/2*(1.-y)*(+x-y-1.)/2
u3 = (1.+x)/2*(1.+y)*(+x+y-1.)/2
u4 = (1.-x)/2*(1.+y)*(-x+y-1.)/2
u5 = (1.-x)/2*(1.+x)(1.-y)/2
u6 = (1.+x)/2*(1.+y)(1.-y)/2
u7 = (1.-x)/2*(1.+x)(1.+y)/2
u8 = (1.-x)/2*(1.+y)(1.-y)/2
end d2q8.sub

sub d2q9.sub(u1,u2,u3,u4,u5,u6,u7,u8,u9,x,y)
u1 = x*(x-1.)/2*y*(y-1.)/2
u5 = (1.-x*x)*y*(y-1.)/2
u2 = x*(1.+x)/2*y*(y-1.)/2
u8 = x*(x-1.)/2*(1.-y*y)
u9 = (1.-x*x)*(1.-y*y)
u6 = x*(1.+x)/2*(1.-y*y)
u4 = x*(x-1.)/2*y*(1.+y)/2
u7 = (1.-x*x)*y*(1.+y)/2
u3 = x*(1.+x)/2*y*(1.+y)/2
end d2q9.sub

sub d2t3.sub(u1,u2,u3,x,y)
u1=x
u2=y
u3=(1.-x-y)
end d2t3.sub

sub d2t3c.sub(u1,u2,u3,x,y)
u1=1.0/3.0
u2=1.0/3.0
u3=1.0/3.0
end d2t3c.sub

sub d2t3m.sub(u1,ux1,uy1,u2,ux2,uy2,u3,ux3,uy3,x,y)
u1=(x+x*x*y+x*x*(1-x-y)-x*y*y-x*(1-x-y)*(1-x-y))
u2=(y+y*y*(1-x-y)+y*y*x-y*(1-x-y)*(1-x-y)-y*x*x)
u3=((1-x-y)+(1-x-y)*(1-x-y)*x+(1-x-y)*(1-x-y)*y-(1-x-y)*x*x-(1-x-y)*y*y)
ux1=((x*x*(1-x-y)+x*y*(1-x-y)/2)-b3*(x*x*y+x*y*(1-x-y)/2))*rctr(2,1)
ux2=((y*y*x+x*y*(1-x-y)/2)-b1*(y*y*(1-x-y)+x*y*(1-x-y)/2))*rctr(2,1)
ux3=(((1-x-y)*y*y+x*y*(1-x-y)/2)-b2*((1-x-y)*(1-x-y)*x+x*y*(1-x-y)/2))*rctr(2,1)
uy1=((x*x*(1-x-y)+x*y*(1-x-y)/2)-d3*(x*x*y+x*y*(1-x-y)/2))*rctr(1,2)
uy2=((y*y*x+x*y*(1-x-y)/2)-d1*(y*y*(1-x-y)+x*y*(1-x-y)/2))*rctr(1,2)
uy3=(((1-x-y)*(1-x-y)*y+x*y*(1-x-y)/2)-d2*((1-x-y)*(1-x-y)*x+x*y*(1-x-y)/2))*rctr(1,2)
end d2t3m.sub

sub d2t3p.sub(u1,ux1,uy1,u2,ux2,uy2,u3,ux3,uy3,x,y)
u1=(x+x*x*y+x*x*(1-x-y)-x*y*y-x*(1-x-y)*(1-x-y))
u2=(y+y*y*(1-x-y)+y*y*x-y*(1-x-y)*(1-x-y)-y*x*x)
u3=((1-x-y)+(1-x-y)*(1-x-y)*x+(1-x-y)*(1-x-y)*y-(1-x-y)*x*x-(1-x-y)*y*y)
ux1=(b2*(x*x*(1-x-y)+x*y*(1-x-y)/2)-b3*(x*x*y+x*y*(1-x-y)/2))
ux2=(b3*(y*y*x+x*y*(1-x-y)/2)-b1*(y*y*(1-x-y)+x*y*(1-x-y)/2))
ux3=(b1*((1-x-y)*(1-x-y)*y+x*y*(1-x-y)/2)-b2*((1-x-y)*(1-x-y)*x+x*y*(1-x-y)/2))
uy1=(d2*(x*x*(1-x-y)+x*y*(1-x-y)/2)-d3*(x*x*y+x*y*(1-x-y)/2))
uy2=(d3*(y*y*x+x*y*(1-x-y)/2)-d1*(y*y*(1-x-y)+x*y*(1-x-y)/2))
uy3=(d1*((1-x-y)*(1-x-y)*y+x*y*(1-x-y)/2)-d2*((1-x-y)*(1-x-y)*x+x*y*(1-x-y)/2))
end d2t3p.sub

sub d2t6.sub(u1,u2,u3,u4,u5,u6,x,y)
u1=x*(2.*x-1.)
u4=x*y*4.
u2=y*(2.*y-1.)
u5=y*(1.-x-y)*4.
u3=(1.-2.*x-2.*y)*(1.-x-y)
u6=x*(1.-x-y)*4.
end d2t6.sub

sub d3c20.sub(u1,u2,u3,u4,u5,u6,u7,u8,u9,u10,u11,u12,u13,u14,u15,u16,u17,u18,u19,u20,x,y,z)
u1=(1.-x)*(1.-y)*(1.-z)*(-x-y-z-2.)/8
u2=(1.+x)*(1.-y)*(1.-z)*(+x-y-z-2.)/8
u3=(1.+x)*(1.+y)*(1.-z)*(+x+y-z-2.)/8
u4=(1.-x)*(1.+y)*(1.-z)*(-x+y-z-2.)/8
u5=(1.-x)*(1.-y)*(1.+z)*(-x-y+z-2.)/8
u6=(1.+x)*(1.-y)*(1.+z)*(+x-y+z-2.)/8
u7=(1.+x)*(1.+y)*(1.+z)*(+x+y+z-2.)/8
u8=(1.-x)*(1.+y)*(1.+z)*(-x+y+z-2.)/8
u9=(1.-x)*(1.+x)*(1.-y)*(1.-z)/4
u10=(1.+x)*(1.+y)*(1.-y)*(1.-z)/4
u11=(1.-x)*(1.+x)*(1.+y)*(1.-z)/4
u12=(1.-x)*(1.+y)*(1.-y)*(1.-z)/4
u17=(1.-x)*(1.+x)*(1.-y)*(1.+z)/4
u18=(1.+x)*(1.+y)*(1.-y)*(1.+z)/4
u19=(1.+x)*(1.-x)*(1.+y)*(1.+z)/4
u20=(1.-x)*(1.+y)*(1.-y)*(1.+z)/4
u13=(1.-x)*(1.-y)*(1.+z)*(1.-z)/4
u14=(1.+x)*(1.-y)*(1.+z)*(1.-z)/4
u15=(1.+x)*(1.+y)*(1.+z)*(1.-z)/4
u16=(1.-x)*(1.+y)*(1.+z)*(1.-z)/4
end d3c20.sub

sub d3c27.sub(u1,u2,u3,u4,u5,u6,u7,u8,u9,u10,u11,u12,u13,u14,u15,u16,u17,u18,u19,u20,u21,u22,u23,u24,u25,u26,u27,x,y,z)
u1 = x*(x-1.)/2*y*(y-1.)/2*z*(z-1.)/2
u9 = (1.-x*x)*y*(y-1.)/2*z*(z-1.)/2
u2 = x*(1.+x)/2*y*(y-1.)/2*z*(z-1.)/2
u12 = x*(x-1.)/2*(1.-y*y)*z*(z-1.)/2
u21 = (1.-x*x)*(1.-y*y)*z*(z-1.)/2
u10 = x*(1.+x)/2*(1.-y*y)*z*(z-1.)/2
u4 = x*(x-1.)/2*y*(1.+y)/2*z*(z-1.)/2
u11 = (1.-x*x)*y*(1.+y)/2*z*(z-1.)/2
u3 = x*(1.+x)/2*y*(1.+y)/2*z*(z-1.)/2
u13 = x*(x-1.)/2*y*(y-1.)/2*(1.-z*z)
u22 = (1.-x*x)*y*(y-1.)/2*(1.-z*z)
u14 = x*(1.+x)/2*y*(y-1.)/2*(1.-z*z)
u25 = x*(x-1.)/2*(1.-y*y)*(1.-z*z)
u27 = (1.-x*x)*(1.-y*y)*(1.-z*z)
u23 = x*(1.+x)/2*(1.-y*y)*(1.-z*z)
u16 = x*(x-1.)/2*y*(1.+y)/2*(1.-z*z)
u24 = (1.-x*x)*y*(1.+y)/2*(1.-z*z)
u15 = x*(1.+x)/2*y*(1.+y)/2*(1.-z*z)
u5 = x*(x-1.)/2*y*(y-1.)/2*z*(1.+z)/2
u17 = (1.-x*x)*y*(y-1.)/2*z*(1.+z)/2
u6 = x*(1.+x)/2*y*(y-1.)/2*z*(1.+z)/2
u20 = x*(x-1.)/2*(1.-y*y)*z*(1.+z)/2
u26 = (1.-x*x)*(1.-y*y)*z*(1.+z)/2
u18 = x*(1.+x)/2*(1.-y*y)*z*(1.+z)/2
u8 = x*(x-1.)/2*y*(1.+y)/2*z*(1.+z)/2
u19 = (1.-x*x)*y*(1.+y)/2*z*(1.+z)/2
u7 = x*(1.+x)/2*y*(1.+y)/2*z*(1.+z)/2
end d3c27.sub

sub d3c8.sub(u1,u2,u3,u4,u5,u6,u7,u8,x,y,z)
u1 = (1.-x)/2*(1.-y)/2*(1.-z)/2
u2 = (1.+x)/2*(1.-y)/2*(1.-z)/2
u3 = (1.+x)/2*(1.+y)/2*(1.-z)/2
u4 = (1.-x)/2*(1.+y)/2*(1.-z)/2
u5 = (1.-x)/2*(1.-y)/2*(1.+z)/2
u6 = (1.+x)/2*(1.-y)/2*(1.+z)/2
u7 = (1.+x)/2*(1.+y)/2*(1.+z)/2
u8 = (1.-x)/2*(1.+y)/2*(1.+z)/2
end d3c8.sub

sub d3c8c.sub(u1,u2,u3,u4,u5,u6,u7,u8,x,y,z)
u1 = 1./8
u2 = 1./8
u3 = 1./8
u4 = 1./8
u5 = 1./8
u6 = 1./8
u7 = 1./8
u8 = 1./8
end d3c8c.sub

sub d3w10.sub(u1,u2,u3,u4,u5,u6,u7,u8,u9,u10,x,y,z)
u1=x*(2.*x-1.)
u5=x*y*4.
u2=y*(2.*y-1.)
u6=y*z*4.
u3=z*(2.*z-1.)
u7=x*z*4.
u8=x*(1.-x-y-z)*4.
u9=y*(1.-x-y-z)*4.
u10=z*(1.-x-y-z)*4.
u4=(1.-2.*x-2.*y-2.*z)*(1.-x-y-z)
end d3w10.sub

sub d3w18.sub(u1,u2,u3,u4,u5,u6,u7,u8,u9,u10,u11,u12,u13,u14,u15,u16,u17,u18,x,y,z)
u1 = x*(2.*x-1.)*z*(z-1.)/2
u10 = x*y*4.*z*(z-1.)/2
u2 = y*(2.*y-1.)*z*(z-1.)/2
u11 = y*(1.-x-y)*4.*z*(z-1.)/2
u3 = (1.-2.*x-2.*y)*(1.-x-y)*z*(z-1.)/2
u12 = x*(1.-x-y)*4.*z*(z-1.)/2
u7 = x*(2.*x-1.)*(1.-z*z)
u16 = x*y*4.*(1.-z*z)
u8 = y*(2.*y-1.)*(1.-z*z)
u17 = y*(1.-x-y)*4.*(1.-z*z)
u9 = (1.-2.*x-2.*y)*(1.-x-y)*(1.-z*z)
u18 = x*(1.-x-y)*4.*(1.-z*z)
u4 = x*(2.*x-1.)*z*(1.+z)/2
u13 = x*y*4.*z*(1.+z)/2
u5 = y*(2.*y-1.)*z*(1.+z)/2
u14 = y*(1.-x-y)*4.*z*(1.+z)/2
u6 = (1.-2.*x-2.*y)*(1.-x-y)*z*(1.+z)/2
u15 = x*(1.-x-y)*4.*z*(1.+z)/2
end d3w18.sub

sub d3w4.sub(u1,u2,u3,u4,x,y,z)
u1=x
u2=y
u3=z
u4=(1.-x-y-z)
end d3w4.sub

sub d3w4c.sub(u1,u2,u3,u4,x,y,z)
u1=1.0/4.0
u2=1.0/4.0
u3=1.0/4.0
u4=1.0/4.0
end d3w4c.sub

sub d3w6.sub(u1,u2,u3,u4,u5,u6,x,y,z)
u1 = x*(1.-z)/2
u2 = y*(1.-z)/2
u3 = (1.-x-y)*(1.-z)/2
u4 = x*(1.+z)/2
u5 = y*(1.+z)/2
u6 = (1.-x-y)*(1.+z)/2
end d3w6.sub

sub d3w6e1.sub(u1,u2,u3,u4,u5,u6,x,y,z)
u1=(crtr(1,1)*(-y)+crtr(2,1)*(x))*nsign(1)
u2=(crtr(2,1)*(-z)+crtr(3,1)*(y))*nsign(2)
u3=(crtr(1,1)*(-z)+crtr(3,1)*(x))*nsign(3)
u4=(crtr(1,1)*(y+z-1)+crtr(2,1)*(-x)+crtr(3,1)*(-x))*nsign(4)
u5=(crtr(1,1)*(-y)+crtr(2,1)*(x+z-1)+crtr(3,1)*(-y))*nsign(5)
u6=(crtr(1,1)*(-z)+crtr(2,1)*(-z)+crtr(3,1)*(x+y-1))*nsign(6)
end d3w6e1.sub

sub d3w6e2.sub(u1,u2,u3,u4,u5,u6,x,y,z)
u1=(crtr(1,2)*(-y)+crtr(2,2)*(x))*nsign(1)
u2=(crtr(2,2)*(-z)+crtr(3,2)*(y))*nsign(2)
u3=(crtr(1,2)*(-z)+crtr(3,2)*(x))*nsign(3)
u4=(crtr(1,2)*(y+z-1)+crtr(2,2)*(-x)+crtr(3,2)*(-x))*nsign(4)
u5=(crtr(1,2)*(-y)+crtr(2,2)*(x+z-1)+crtr(3,2)*(-y))*nsign(5)
u6=(crtr(1,2)*(-z)+crtr(2,2)*(-z)+crtr(3,2)*(x+y-1))*nsign(6)
end d3w6e2.sub

sub d3w6e3.sub(u1,u2,u3,u4,u5,u6,x,y,z)
u1=(crtr(1,3)*(-y)+crtr(2,3)*(x))*nsign(1)
u2=(crtr(2,3)*(-z)+crtr(3,3)*(y))*nsign(2)
u3=(crtr(1,3)*(-z)+crtr(3,3)*(x))*nsign(3)
u4=(crtr(1,3)*(y+z-1)+crtr(2,3)*(-x)+crtr(3,3)*(-x))*nsign(4)
u5=(crtr(1,3)*(-y)+crtr(2,3)*(x+z-1)+crtr(3,3)*(-y))*nsign(5)
u6=(crtr(1,3)*(-z)+crtr(2,3)*(-z)+crtr(3,3)*(x+y-1))*nsign(6)
end d3w6e3.sub

sub d1l2.wei(rou,u)
 [ rou]u_1
+[ rou]u_2
end d1l2.wei

sub d1l3.wei(rou,u)
 [rou]u_1
+[rou]u_3
+[rou]u_2
end d1l3.wei

sub d1l4.wei(rou,u)
 [rou]u_1
+[rou]u_3
+[rou]u_4
+[rou]u_2
end d1l4.wei

sub d2q4.wei(rou,u)
 [ rou]u_1
+[ rou]u_2
+[ rou]u_3
+[ rou]u_4
end d2q4.wei

sub d2q8.wei(rou,u)
 [rou]u_1
+[rou]u_2
+[rou]u_3
+[rou]u_4
+[rou]u_5
+[rou]u_6
+[rou]u_7
+[rou]u_8
end d2q8.wei

sub d2q9.wei(rou,u)
 [rou]u_1
+[rou]u_2
+[rou]u_3
+[rou]u_4
+[rou]u_5
+[rou]u_6
+[rou]u_7
+[rou]u_8
+[rou]u_9
end d2q9.wei

sub d2t3.wei(rou,u)
 [rou]u_1
+[rou]u_2
+[rou]u_3
end d2t3.wei

sub d2t6.wei(rou,u)
 [rou]u_1
+[rou]u_2
+[rou]u_3
+[rou]u_4
+[rou]u_5
+[rou]u_6
end d2t6.wei

sub d3c20.wei(rou,u)
 [rou]u_1
+[rou]u_2
+[rou]u_3
+[rou]u_4
+[rou]u_5
+[rou]u_6
+[rou]u_7
+[rou]u_8
+[rou]u_9
+[rou]u_10
+[rou]u_11
+[rou]u_12
+[rou]u_13
+[rou]u_14
+[rou]u_15
+[rou]u_16
+[rou]u_17
+[rou]u_18
+[rou]u_19
+[rou]u_20
end d3c20.wei

sub d3c27.wei(rou,u)
 [rou]u_1
+[rou]u_2
+[rou]u_3
+[rou]u_4
+[rou]u_5
+[rou]u_6
+[rou]u_7
+[rou]u_8
+[rou]u_9
+[rou]u_10
+[rou]u_11
+[rou]u_12
+[rou]u_13
+[rou]u_14
+[rou]u_15
+[rou]u_16
+[rou]u_17
+[rou]u_18
+[rou]u_19
+[rou]u_20
+[rou]u_21
+[rou]u_22
+[rou]u_23
+[rou]u_24
+[rou]u_25
+[rou]u_26
+[rou]u_27
end d3c27.wei

sub d3c8.wei(rou,u)
 [rou]u_1
+[rou]u_2
+[rou]u_3
+[rou]u_4
+[rou]u_5
+[rou]u_6
+[rou]u_7
+[rou]u_8
end d3c8.wei

sub d3w10.wei(rou,u)
 [rou]u_1
+[rou]u_2
+[rou]u_3
+[rou]u_4
+[rou]u_5
+[rou]u_6
+[rou]u_7
+[rou]u_8
+[rou]u_9
+[rou]u_10
end d3w10.wei

sub d3w18.wei(rou,u)
 [rou]u_1
+[rou]u_2
+[rou]u_3
+[rou]u_4
+[rou]u_5
+[rou]u_6
+[rou]u_7
+[rou]u_8
+[rou]u_9
+[rou]u_10
+[rou]u_11
+[rou]u_12
+[rou]u_13
+[rou]u_14
+[rou]u_15
+[rou]u_16
+[rou]u_17
+[rou]u_18
end d3w18.wei

sub d3w4.wei(rou,u)
 [rou]u_1
+[rou]u_2
+[rou]u_3
+[rou]u_4
end d3w4.wei

sub d3w6.wei(rou,u)
 [rou]u_1
+[rou]u_2
+[rou]u_3
+[rou]u_4
+[rou]u_5
+[rou]u_6
end d3w6.wei

sub d1l2.gau()
 gaus  2
-1. 1.
 1. 1.
end d1l2.gau

sub d1l3.gau()
gaus  3
-1. 1./3.
 0. 4./3.
 1. 1./3.
end d1l3.gau

sub d1l4.gau()
gaus  4
-1.  0.33333333
-0.5 0.66666667
 0.5 0.66666667
 1.  0.33333333
end d1l4.gau

sub d2q4.gau()
gaus = 4
-1. -1. 1.
 1. -1. 1.
 1.  1. 1.
-1.  1. 1.
end d2q4.gau

sub d2q8.gau()
gaus = 8
-1.000000E+00 -1.000000E+00  1./3.
 0.000000E+00 -1.000000E+00  2./3.
 1.000000E+00 -1.000000E+00  1./3.
 1.000000E+00  0.000000E+00  2./3.
 1.000000E+00  1.000000E+00  1./3.
 0.000000E+00  1.000000E+00  2./3.
-1.000000E+00  1.000000E+00  1./3.
-1.000000E+00  0.000000E+00  2./3.
end d2q8.gau

sub d2q9.gau()
gaus = 9
-1.000000E+00 -1.000000E+00   1./9.
 1.000000E+00 -1.000000E+00   1./9.
 1.000000E+00  1.000000E+00   1./9.
-1.000000E+00  1.000000E+00   1./9.
 0.000000E+00 -1.000000E+00   4./9.
 1.000000E+00  0.000000E+00   4./9.
 0.000000E+00  1.000000E+00   4./9.
-1.000000E+00  0.000000E+00   4./9.
 0.000000E+00  0.000000E+00  16./9.
end d2q9.gau

sub d2t3.gau()
gaus =  3
      1.  0.  1./6.
      0.  1.  1./6.
      0.  0.  1./6.
end d2t3.gau

sub d2t6.gau()
gaus =  6
      1.  0.  0.125/3.
      0.5 0.5 0.125
      0.  1.  0.125/3.
      0.  0.5 0.125
      0.  0.  0.125/3.
      0.5 0.  0.125
end d2t6.gau

sub d3c20.gau()
gaus = 20
-1.000000E+00 -1.000000E+00 -1.000000E+00  2.500000E-01
 0.000000E+00 -1.000000E+00 -1.000000E+00  5.000000E-01
 1.000000E+00 -1.000000E+00 -1.000000E+00  2.500000E-01
-1.000000E+00  0.000000E+00 -1.000000E+00  5.000000E-01
 1.000000E+00  0.000000E+00 -1.000000E+00  5.000000E-01
-1.000000E+00  1.000000E+00 -1.000000E+00  2.500000E-01
 0.000000E+00  1.000000E+00 -1.000000E+00  5.000000E-01
 1.000000E+00  1.000000E+00 -1.000000E+00  2.500000E-01
-1.000000E+00 -1.000000E+00  0.000000E+00  5.000000E-01
 1.000000E+00 -1.000000E+00  0.000000E+00  5.000000E-01
-1.000000E+00  1.000000E+00  0.000000E+00  5.000000E-01
 1.000000E+00  1.000000E+00  0.000000E+00  5.000000E-01
-1.000000E+00 -1.000000E+00  1.000000E+00  2.500000E-01
 0.000000E+00 -1.000000E+00  1.000000E+00  5.000000E-01
 1.000000E+00 -1.000000E+00  1.000000E+00  2.500000E-01
-1.000000E+00  0.000000E+00  1.000000E+00  5.000000E-01
 1.000000E+00  0.000000E+00  1.000000E+00  5.000000E-01
-1.000000E+00  1.000000E+00  1.000000E+00  2.500000E-01
 0.000000E+00  1.000000E+00  1.000000E+00  5.000000E-01
 1.000000E+00  1.000000E+00  1.000000E+00  2.500000E-01
end d3c20.gau

sub d3c27.gau()
gaus = 27
-1.000000E+00 -1.000000E+00 -1.000000E+00   1./27.
 1.000000E+00 -1.000000E+00 -1.000000E+00   1./27.
 1.000000E+00  1.000000E+00 -1.000000E+00   1./27.
-1.000000E+00  1.000000E+00 -1.000000E+00   1./27.
-1.000000E+00 -1.000000E+00  1.000000E+00   1./27.
 1.000000E+00 -1.000000E+00  1.000000E+00   1./27.
 1.000000E+00  1.000000E+00  1.000000E+00   1./27.
-1.000000E+00  1.000000E+00  1.000000E+00   1./27.
 0.000000E+00 -1.000000E+00 -1.000000E+00   4./27.
 1.000000E+00  0.000000E+00 -1.000000E+00   4./27.
 0.000000E+00  1.000000E+00 -1.000000E+00   4./27.
-1.000000E+00  0.000000E+00 -1.000000E+00   4./27.
-1.000000E+00 -1.000000E+00  0.000000E+00   4./27.
 1.000000E+00 -1.000000E+00  0.000000E+00   4./27.
 1.000000E+00  1.000000E+00  0.000000E+00   4./27.
-1.000000E+00  1.000000E+00  0.000000E+00   4./27.
 0.000000E+00 -1.000000E+00  1.000000E+00   4./27.
 1.000000E+00  0.000000E+00  1.000000E+00   4./27.
 0.000000E+00  1.000000E+00  1.000000E+00   4./27.
-1.000000E+00  0.000000E+00  1.000000E+00   4./27.
 0.000000E+00  0.000000E+00 -1.000000E+00  16./27.
 0.000000E+00 -1.000000E+00  0.000000E+00  16./27.
 1.000000E+00  0.000000E+00  0.000000E+00  16./27.
 0.000000E+00  1.000000E+00  0.000000E+00  16./27.
-1.000000E+00  0.000000E+00  0.000000E+00  16./27.
 0.000000E+00  0.000000E+00  1.000000E+00  16./27.
 0.000000E+00  0.000000E+00  0.000000E+00  64./27.
end d3c27.gau

sub d3c8.gau()
gaus = 8
-1.000000E+00 -1.000000E+00 -1.000000E+00  1.000000E+00
 1.000000E+00 -1.000000E+00 -1.000000E+00  1.000000E+00
 1.000000E+00  1.000000E+00 -1.000000E+00  1.000000E+00
-1.000000E+00  1.000000E+00 -1.000000E+00  1.000000E+00
-1.000000E+00 -1.000000E+00  1.000000E+00  1.000000E+00
 1.000000E+00 -1.000000E+00  1.000000E+00  1.000000E+00
 1.000000E+00  1.000000E+00  1.000000E+00  1.000000E+00
-1.000000E+00  1.000000E+00  1.000000E+00  1.000000E+00
end d3c8.gau

sub d3w10.gau()
gaus = 10
 1. 0. 0. 1./96.
 .5 .5 0. 1./48.
 0. 1. 0. 1./96.
 0. .5 .5 1./48.
 0. 0. 1. 1./96.
 .5 0. .5 1./48.
 .5 0. 0. 1./48.
 0. .5 0. 1./48.
 0. 0. .5 1./48.
 0. 0. 0. 1./96.
end d3w10.gau

sub d3w18.gau()
gaus = 18
 1.000000E+00  0.000000E+00 -1.000000E+00  2.083334E-02
 5.000000E-01  5.000000E-01 -1.000000E+00  6.250000E-02
 0.000000E+00  1.000000E+00 -1.000000E+00  2.083334E-02
 0.000000E+00  5.000000E-01 -1.000000E+00  6.250000E-02
 0.000000E+00  0.000000E+00 -1.000000E+00  2.083334E-02
 5.000000E-01  0.000000E+00 -1.000000E+00  6.250000E-02
 1.000000E+00  0.000000E+00  0.000000E+00  4.166667E-02
 5.000000E-01  5.000000E-01  0.000000E+00  1.250000E-01
 0.000000E+00  1.000000E+00  0.000000E+00  4.166667E-02
 0.000000E+00  5.000000E-01  0.000000E+00  1.250000E-01
 0.000000E+00  0.000000E+00  0.000000E+00  4.166667E-02
 5.000000E-01  0.000000E+00  0.000000E+00  1.250000E-01
 1.000000E+00  0.000000E+00  1.000000E+00  2.083334E-02
 5.000000E-01  5.000000E-01  1.000000E+00  6.250000E-02
 0.000000E+00  1.000000E+00  1.000000E+00  2.083334E-02
 0.000000E+00  5.000000E-01  1.000000E+00  6.250000E-02
 0.000000E+00  0.000000E+00  1.000000E+00  2.083334E-02
 5.000000E-01  0.000000E+00  1.000000E+00  6.250000E-02
end d3w18.gau

sub d3w4.gau()
gaus = 4
 1.000000E+00  0.000000E+00   0.000000E+00  1./24.
 0.000000E+00  1.000000E+00   0.000000E+00  1./24.
 0.000000E+00  0.000000E+00   0.000000E+00  1./24.
 0.000000E+00  0.000000E+00   1.000000E+00  1./24.
end d3w4.gau

sub d3w6.gau()
gaus = 6
 1.000000E+00  0.000000E+00 -1.000000E+00  1./6.
 0.000000E+00  1.000000E+00 -1.000000E+00  1./6.
 0.000000E+00  0.000000E+00 -1.000000E+00  1./6.
 1.000000E+00  0.000000E+00  1.000000E+00  1./6.
 0.000000E+00  1.000000E+00  1.000000E+00  1./6.
 0.000000E+00  0.000000E+00  1.000000E+00  1./6.
end d3w6.gau

sub d2t3.mid()
gaus =  3
      0.5  0.0  1./6.
      0.5  0.5  1./6.
      0.0  0.5  1./6.
end d2t3.mid

sub d2t6.mid()
gaus =  3
      0.5  0.0  1./6.
      0.5  0.5  1./6.
      0.0  0.5  1./6.
end d2t6.mid

sub d3w10.mid()
gaus = 6
 .5 .5 0. 1./36.
 0. .5 .5 1./36.
 .5 0. .5 1./36.
 .5 0. 0. 1./36.
 0. .5 0. 1./36.
 0. 0. .5 1./36.
end d3w10.mid

sub d3w18.mid()
gaus = 9
 0.000000E+00  5.000000E-01 -1.000000E+00  8.333330E-02
 5.000000E-01  0.000000E+00 -1.000000E+00  8.333330E-02
 5.000000E-01  5.000000E-01 -1.000000E+00  8.333330E-02
 0.000000E+00  5.000000E-01  0.000000E+00  1.666666E-01
 5.000000E-01  0.000000E+00  0.000000E+00  1.666666E-01
 5.000000E-01  5.000000E-01  0.000000E+00  1.666666E-01
 0.000000E+00  5.000000E-01  1.000000E+00  8.333330E-02
 5.000000E-01  0.000000E+00  1.000000E+00  8.333330E-02
 5.000000E-01  5.000000E-01  1.000000E+00  8.333330E-02
end d3w18.mid

sub d3w6.mid()
gaus = 6
 0.500000E+00  0.000000E+00 -1.000000E+00  1./6.
 0.500000E+00  0.500000E+00 -1.000000E+00  1./6.
 0.000000E+00  0.500000E+00 -1.000000E+00  1./6.
 0.500000E+00  0.000000E+00  1.000000E+00  1./6.
 0.500000E+00  0.500000E+00  1.000000E+00  1./6.
 0.000000E+00  0.500000E+00  1.000000E+00  1./6.
end d3w6.mid

sub w.v()
gaus = 4
 1.000000E+00  0.000000E+00   0.000000E+00  1./24.
 0.000000E+00  1.000000E+00   0.000000E+00  1./24.
 0.000000E+00  0.000000E+00   0.000000E+00  1./24.
 0.000000E+00  0.000000E+00   1.000000E+00  1./24.
end w.v
